<div id="formContent">

    <h2 class="active">Inserimento cantiere</h2>
    <!-- Icon -->
    <div>
        <img src="../img/logo_login_senza_background.png" />
    </div>

    <!-- Login Form -->
       
    <form>
    <input type="text" class="aggCampi" id="idNome" name="nome" placeholder="Nome" required>
    <input type="text" class="aggCampi" id="idIndirizzo" name="indirizzo" placeholder="Indirizzo" required>
    <input type="text" class="aggCampi" id="idCitta" name="citta" placeholder="CittÃ " required>
    <input type="text" class="aggCampi" id="idProvincia" name="provincia" placeholder="Provincia" maxlength="2" required>
    <label for="idDataInizio">Data di inizio:</label>
    <input type="date" class="aggCampi" id="idDataInizio" name="dataInizio" placeholder="Data inizio" required>
    <input type="text" class="aggCampi" id="idDescrizione" name="descrizione" placeholder="Descrizione" required>
    <input type="submit" value="Aggiungi" onclick="return aggiungiCantiere();">
    <div id="cantiereNewError" style="color:red"></div>
</form>
</div>
<script>
    class CantiereNew{
        constructor(nome, indirizzo, citta, provincia, data_inizio, descrizione) {
            this.nome = nome;
            this.indirizzo = indirizzo;
            this.citta = citta;
            this.provincia = provincia;
            this.data_inizio = data_inizio;
            this.descrizione = descrizione;
        }

    }

    function aggiungiCantiere() {
        let nome = document.getElementById("idNome").value;
        let indirizzo = document.getElementById("idIndirizzo").value;
        let citta = document.getElementById("idCitta").value;
        let provincia = document.getElementById("idProvincia").value;
        let data_inizio = document.getElementById("idDataInizio").value;
        let descrizione = document.getElementById("idDescrizione").value;
        let error=document.getElementById("cantiereNewError");    
        error.innerHTML = '';

        if(nome.length<1 || indirizzo.length<1 || citta.length<1 || provincia.length<1 || data_inizio.length<1 || descrizione.length<1) {
            error.innerHTML = "Inserisci tutti i campi";
            return false;
        }

        let obj = new CantiereNew(nome, indirizzo, citta, provincia, data_inizio, descrizione);

        let rc2 = fetch('http://localhost/cantieroni/API/cantiere/create_new.php', { method: 'POST' ,credentials: 'include', headers: {
                'Accept': 'application/json',
                'Content-type': 'application/json'
            }, body: JSON.stringify(obj)})
            .then((response) => {
                if (response.ok) {
                    return response.json();
                }
                throw new Error(response.statusText);
            })
            .then((data) => {
                location.reload();
            }).catch((err) => {
                error.innerHTML = err;
                console.log(err);
            });
        return false;
    }

</script>

<!-- <script src="../js/cantieriAll.js"></script> -->
<!--<script src="../js/inserCantiere.js"></script>-->